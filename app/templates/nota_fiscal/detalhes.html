{% extends 'base.html' %} 
{% block content %}
<div class="container mt-4">
  <!-- Cabeçalho -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-semibold text-primary">
      <i class="bi bi-file-text me-2"></i>
      Detalhes da Nota Fiscal
    </h4>
    <a href="{{ url_for('nota_fiscal.historico') }}" class="btn btn-secondary shadow-sm">
      <i class="bi bi-arrow-left"></i> Voltar
    </a>
  </div>

  <!-- Dados principais da nota -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row mb-3">
        <div class="col-md-3">
          <label class="form-label fw-semibold">Número NF</label>
          <input type="text" class="form-control" value="{{ nota.numero_nf }}" readonly />
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Reserva</label>
          <input type="text" class="form-control" value="{{ nota.reserva or '—' }}" readonly />
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Tipo de Serviço</label>
          <input type="text" class="form-control" value="{{ nota.tipo_servico_ref.nome if nota.tipo_servico_ref else nota.tipo_servico or '—' }}" readonly />
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Responsável</label>
          <input type="text" class="form-control" value="{{ nota.responsavel or '—' }}" readonly />
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-12">
          <label class="form-label fw-semibold">Observação</label>
          <textarea class="form-control" rows="2" readonly>{{ nota.observacao or '' }}</textarea>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <label class="form-label fw-semibold">Data de Registro</label>
          <input type="text" class="form-control" value="{{ nota.data_hora.strftime('%d/%m/%Y %H:%M') }}" readonly />
        </div>
      </div>
    </div>
  </div>

  <!-- Itens da Nota -->
  <h5 class="mb-3 fw-semibold text-primary">
    <i class="bi bi-box-seam me-2"></i>Itens da Nota
  </h5>
  <div class="table-responsive shadow-sm">
    <table class="table table-bordered table-hover table-sm align-middle">
      <thead style="position: sticky; top: 0; z-index: 10; background-color: #002b55; color: white;">
        <tr>
          <th>Código</th>
          <th>Descrição</th>
          <th>Unidade</th>
          <th class="text-end">Quantidade</th>
          <th class="text-end">Valor Unitário (R$)</th>
          <th class="text-end">Total Item (R$)</th>
        </tr>
      </thead>
      <tbody>
        {% for item in itens %}
        <tr>
          <td>{{ item.item.codigo }}</td>
          <td>{{ item.item.descricao }}</td>
          <td>{{ item.item.unidade }}</td>
          <td class="text-end">{{ item.quantidade }}</td>
          <td class="text-end">{{ item.valor_unitario|brl }}</td>
          <td class="text-end">{{ (item.quantidade * item.valor_unitario)|brl }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6" class="text-center text-muted">
            Nenhum item registrado.
          </td>
        </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr class="table-light fw-bold">
          <td colspan="5" class="text-end">Total da Nota:</td>
          <td class="text-end">{{ total_nota|brl }}</td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
{% endblock %}
