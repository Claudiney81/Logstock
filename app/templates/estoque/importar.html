{% extends 'base.html' %} {% block content %}
<div class="container mt-4">
  <h2>Importar Itens via Excel (XLSX)</h2>

  {% with messages = get_flashed_messages(with_categories=true) %} {% if
  messages %} {% for category, message in messages %}
  <div class="alert alert-{{ category }}">{{ message }}</div>
  {% endfor %} {% endif %} {% endwith %}

  <form method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label for="arquivo" class="form-label"
        >Selecione o arquivo Excel (.xlsx)</label
      >
      <input
        type="file"
        class="form-control"
        id="arquivo"
        name="arquivo"
        accept=".xlsx"
        required
      />
      <div class="form-text text-muted">
        O arquivo deve estar no formato Excel (.xlsx) com as colunas:
        <strong>Código</strong>, <strong>Descrição</strong>,
        <strong>Unidade</strong>, <strong>Tipo de Serviço</strong> e
        <strong>Valor</strong>.
      </div>
    </div>
    <button type="submit" class="btn btn-primary">Importar</button>
  </form>

  <div class="mt-4">
    <h5>Formato esperado do arquivo Excel:</h5>
    <ul>
      <li>
        Primeira linha com cabeçalhos: Código, Descrição, Unidade, Tipo de
        Serviço, Valor
      </li>
      <li>As demais linhas devem conter os dados dos itens</li>
      <li>Evite linhas em branco ou colunas adicionais</li>
    </ul>
  </div>
</div>
{% endblock %}
